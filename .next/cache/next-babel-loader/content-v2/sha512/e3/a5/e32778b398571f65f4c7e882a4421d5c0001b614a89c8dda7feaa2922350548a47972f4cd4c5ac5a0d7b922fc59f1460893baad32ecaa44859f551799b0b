{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/paulo/Desktop/Private_Blockchain/Web/WebApp/pages/data/submit.js\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from \"react\";\nimport { Form, Button, Message } from \"semantic-ui-react\";\nimport contract from \"../../Ethereum/contract\";\nimport web3 from \"../../Ethereum/web3\";\nimport { ethers } from \"ethers\";\nimport Common from \"ethereumjs-common\";\nimport { bufferToHex, privateToAddress } from \"ethereumjs-util\";\nimport Layout from \"../../components/Layout\";\nimport { Router } from '../../routes';\n\nvar Tx = require(\"ethereumjs-tx\");\n\nclass Submit extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      type: \"\",\n      minPay: \"\",\n      id: \"\",\n      errorMessage: \"\",\n      successMessage: \"\",\n      loading: false\n    });\n\n    _defineProperty(this, \"onSubmit\", async event => {\n      event.preventDefault();\n      this.setState({\n        loading: true,\n        errorMessage: \"\",\n        successMessage: \"\"\n      });\n      const timestamp = +new Date();\n      console.log(timestamp);\n\n      switch (this.state.type.toLowerCase()) {\n        case \"temp\":\n          var tag = 1;\n          break;\n\n        case \"hum\":\n          var tag = 2;\n          break;\n\n        case \"both\":\n          var tag = 3;\n          break;\n\n        case \"pressure\":\n          var tag = 4;\n          break;\n\n        case \"test\":\n          var tag = 5;\n          break;\n\n        default:\n          var tag = 0;\n          break;\n      } // console.log(tag);\n\n\n      try {\n        const addressFrom = \"0x0af773490541a1a32e6bce0ac319975b1f4734ca\"; //\"0x1206D8C3c73e40c8AfD0D878bbaa28609F9A72a9\";\n\n        var privateKey = new Buffer.from(\"6ceeebd2bf996d1998d2778bb86a1c200d4423f1443dc51ee52c92076380e97b\", //\"e8d1574304a68b5f794d33a842389350d93e49d46b6871571f9b64eaa53131ec\",\n        \"hex\");\n        var nonceNumber = web3.utils.toHex(await web3.eth.getTransactionCount(addressFrom, \"pending\")); //console.log(nonceNumber);\n\n        const customCommon = Common.forCustomChain(\"mainnet\", {\n          name: \"TestNetwork\",\n          networkId: 7777,\n          chainId: 7777\n        }, \"petersburg\");\n        var myData = contract.methods.EmitEvent(this.state.type, timestamp.toString(), this.state.minPay, this.state.id, tag).encodeABI();\n        var rawTx = {\n          nonce: nonceNumber,\n          from: addressFrom,\n          gasLimit: web3.utils.toHex(100000),\n          gasPrice: web3.utils.toHex(10e9),\n          to: contract._address,\n          data: myData\n        };\n        var tx = new Tx.Transaction(rawTx, {\n          common: customCommon\n        });\n        tx.sign(privateKey);\n        var serializedTx = tx.serialize();\n        var receipt = await web3.eth.sendSignedTransaction(\"0x\" + serializedTx.toString(\"hex\")).on(\"receipt\", console.log);\n        this.setState({\n          successMessage: \"Transaction successfull, transaction hash: \" + receipt.transactionHash\n        }); // Router.pushRoute('/');\n      } catch (error) {\n        this.setState({\n          errorMessage: error.message\n        });\n      }\n\n      this.setState({\n        loading: false\n      });\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Layout, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Welcome to the Events Contract!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\" \", \"Fill the form below to send data information to the blockchain:\", \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Form, {\n          onSubmit: this.onSubmit,\n          error: !!this.state.errorMessage,\n          success: !!this.state.successMessage,\n          children: [/*#__PURE__*/_jsxDEV(Form.Input, {\n            fluid: true,\n            label: {\n              children: \"Data Type:\",\n              style: {\n                fontSize: '16px'\n              }\n            },\n            placeholder: \"Temp / Humidity / Both\",\n            id: \"datatype\",\n            value: this.state.type,\n            onChange: event => this.setState({\n              type: event.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n            fluid: true,\n            label: {\n              children: \"Minimum Payment (in Tokens): \",\n              style: {\n                fontSize: '16px'\n              }\n            },\n            placeholder: \"Min. Payment\",\n            value: this.state.minPay,\n            onChange: event => this.setState({\n              minPay: event.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n            fluid: true,\n            label: {\n              children: \"Serial number: \",\n              style: {\n                fontSize: '16px'\n              }\n            },\n            placeholder: \"Serial Number\",\n            value: this.state.id,\n            onChange: event => this.setState({\n              id: event.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Message, {\n            error: true,\n            header: \"Oops!\",\n            content: this.state.errorMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Message, {\n            success: true,\n            header: \"Completed!\",\n            content: this.state.successMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            loading: this.state.loading,\n            primary: true,\n            children: \"Submit!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Submit;","map":{"version":3,"sources":["/home/paulo/Desktop/Private_Blockchain/Web/WebApp/pages/data/submit.js"],"names":["React","Component","Form","Button","Message","contract","web3","ethers","Common","bufferToHex","privateToAddress","Layout","Router","Tx","require","Submit","type","minPay","id","errorMessage","successMessage","loading","event","preventDefault","setState","timestamp","Date","console","log","state","toLowerCase","tag","addressFrom","privateKey","Buffer","from","nonceNumber","utils","toHex","eth","getTransactionCount","customCommon","forCustomChain","name","networkId","chainId","myData","methods","EmitEvent","toString","encodeABI","rawTx","nonce","gasLimit","gasPrice","to","_address","data","tx","Transaction","common","sign","serializedTx","serialize","receipt","sendSignedTransaction","on","transactionHash","error","message","render","onSubmit","children","style","fontSize","target","value"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Form, Button, Message } from \"semantic-ui-react\";\nimport contract from \"../../Ethereum/contract\";\nimport web3 from \"../../Ethereum/web3\";\nimport { ethers } from \"ethers\";\nimport Common from \"ethereumjs-common\";\nimport { bufferToHex, privateToAddress } from \"ethereumjs-util\";\nimport Layout from \"../../components/Layout\";\nimport { Router } from '../../routes';\nvar Tx = require(\"ethereumjs-tx\");\n\nclass Submit extends Component {\n  state = {\n    type: \"\",\n    minPay: \"\",\n    id: \"\",\n    errorMessage: \"\",\n    successMessage: \"\",\n    loading: false,\n  };\n\n  onSubmit = async (event) => {\n    event.preventDefault();\n    this.setState({ loading: true, errorMessage: \"\", successMessage: \"\" });\n\n    const timestamp = +new Date();\n    console.log(timestamp);\n\n      switch (this.state.type.toLowerCase()) {\n        case \"temp\":\n          var tag = 1;\n          break;\n        case \"hum\":\n          var tag = 2;\n          break;\n        case \"both\":\n          var tag = 3;\n          break;\n        case \"pressure\":\n          var tag = 4;\n          break;\n        case \"test\":\n          var tag = 5;\n          break;\n        default:\n          var tag = 0;\n          break;\n      }\n      // console.log(tag);\n\n      try {\n      const addressFrom = \"0x0af773490541a1a32e6bce0ac319975b1f4734ca\";\n      //\"0x1206D8C3c73e40c8AfD0D878bbaa28609F9A72a9\";\n      var privateKey = new Buffer.from(\n        \"6ceeebd2bf996d1998d2778bb86a1c200d4423f1443dc51ee52c92076380e97b\",\n        //\"e8d1574304a68b5f794d33a842389350d93e49d46b6871571f9b64eaa53131ec\",\n        \"hex\"\n      );\n      var nonceNumber = web3.utils.toHex(\n        await web3.eth.getTransactionCount(addressFrom, \"pending\")\n      );\n      //console.log(nonceNumber);\n      const customCommon = Common.forCustomChain(\n        \"mainnet\",\n        {\n          name: \"TestNetwork\",\n          networkId: 7777,\n          chainId: 7777,\n        },\n        \"petersburg\"\n      );\n\n      var myData = contract.methods\n        .EmitEvent(\n          this.state.type,\n          timestamp.toString(),\n          this.state.minPay,\n          this.state.id,\n          tag\n        )\n        .encodeABI();\n\n      var rawTx = {\n        nonce: nonceNumber,\n        from: addressFrom,\n        gasLimit: web3.utils.toHex(100000),\n        gasPrice: web3.utils.toHex(10e9),\n        to: contract._address,\n        data: myData,\n      };\n\n      var tx = new Tx.Transaction(rawTx, { common: customCommon });\n      tx.sign(privateKey);\n      var serializedTx = tx.serialize();\n      \n      var receipt = await web3.eth\n        .sendSignedTransaction(\"0x\" + serializedTx.toString(\"hex\"))\n        .on(\"receipt\", console.log);\n\n        this.setState({successMessage: \"Transaction successfull, transaction hash: \" + receipt.transactionHash});\n    \n       // Router.pushRoute('/');\n    } catch (error) {\n      this.setState({ errorMessage: error.message });\n    }\n    this.setState({loading: false})\n  };\n\n  render() {\n    return (\n      <Layout>\n        <div>\n          <h2>Welcome to the Events Contract!</h2>\n          <h3>\n            {\" \"}\n            Fill the form below to send data information to the blockchain:{\" \"}\n          </h3>\n          <Form onSubmit={this.onSubmit} error={!!this.state.errorMessage} success={!!this.state.successMessage}>\n            <Form.Input\n              fluid\n              label={{ children: \"Data Type:\", style:{ fontSize: '16px' } }}\n              placeholder=\"Temp / Humidity / Both\"\n              id=\"datatype\"\n              value={this.state.type}\n              onChange={(event) => this.setState({ type: event.target.value })}\n            />\n            <Form.Input\n              fluid\n              label={{ children: \"Minimum Payment (in Tokens): \", style:{ fontSize: '16px' } }}\n              placeholder=\"Min. Payment\"\n              value={this.state.minPay}\n              onChange={(event) =>\n                this.setState({ minPay: event.target.value })\n              }\n            />\n            <Form.Input\n              fluid\n              label={{ children: \"Serial number: \", style:{ fontSize: '16px' } }}\n              placeholder=\"Serial Number\"\n              value={this.state.id}\n              onChange={(event) => this.setState({ id: event.target.value })}\n            />\n            <h4></h4>\n            <Message error header=\"Oops!\" content={this.state.errorMessage} />\n            <Message success header=\"Completed!\" content={this.state.successMessage} />\n            <Button loading={this.state.loading} primary>\n              Submit!\n            </Button>\n          </Form>\n        </div>\n      </Layout>\n    );\n  }\n}\n\nexport default Submit;\n"]},"metadata":{},"sourceType":"module"}